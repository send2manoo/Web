<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <meta charset="utf-8"/>
        <title>FieldSense</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
        <meta content="" name="description"/>
        <meta content="" name="author"/>
        <meta name="MobileOptimized" content="320">
        <link rel="stylesheet" type="text/css" href="assets/plugins/bootstrap-toastr/toastr.min.css"/>
        <link href="assets/css/style.css" rel="stylesheet" type="text/css"/>
        <link href="assets/css/plugins.css" rel="stylesheet" type="text/css"/>
        <!-- END THEME STYLES -->
        <link rel="shortcut icon" href="assets/img/favicon.ico"/>
    </head>
    <body>        
        <div>
            <input type="text" id="id_uemail"  />
            <button type="button" class="btn btn-info" onclick="createNewAccount()">Register</button>
        </div>
            <script>                
                function createNewAccount() {
                    var uemail = document.getElementById("id_uemail").value.trim();
                    console.log("uemail : " + uemail);
                    var createAccountObject = {
                        "emailAddress": uemail // do not change this object name > "emailAddress"
                    }

                    var jsonObj = JSON.stringify(createAccountObject);
                    var fieldSenseURL = "http://test.web.fieldsense.in"; // test/live url
                    $.ajax({
                        type : "POST",
                        url : fieldSenseURL +"/FieldSense/account/sendMailWithSecureLink",
                        contentType : "application/json; charset=utf-8",
                        data : jsonObj,
                        dataType : 'json',
                        crossDomain: false,
                        cache: false,
                        success : function(data){
                            if (data.errorCode == '0000') { // errorcode for successfully sent mails
                                fieldSenseTosterSuccess(data.errorMessage, true);
                            }
                            else if (data.errorCode == '3333') { // errorcode for existing users
                                fieldSenseTosterInfo(data.errorMessage, true);
                                window.location.replace = "http://test.web.fieldsense.in/FieldSenseWeb/login.html"; // test/live url
                            }
                            else {
                                fieldSenseTosterError(data.errorMessage, true);
                            }
                        }

                    });

                }
                
                function fieldSenseTosterSuccess(message, isClosable) {
                    toastr.options = {
                        "closeButton": isClosable,
                        "debug": false,
                        "positionClass": "toast-top-center",
                        "onclick": null,
                        "showDuration": "1000",
                        "hideDuration": "1000",
                        "timeOut": "5000",
                        "extendedTimeOut": "1000",
                        "showEasing": "swing",
                        "hideEasing": "linear",
                        "showMethod": "fadeIn",
                        "hideMethod": "fadeOut"
                    }
                    toastr.success(message);
                }
                function fieldSenseTosterSuccess1(message, isClosable) {
                    toastr.options = {
                        "closeButton": isClosable,
                        "debug": false,
                        "positionClass": "toast-top-center",
                        "onclick": null,
                        "showDuration": "1000",
                        "hideDuration": "1000",
                        "timeOut": "50000",
                        "extendedTimeOut": "1000",
                        "showEasing": "swing",
                        "hideEasing": "linear",
                        "showMethod": "fadeIn",
                        "hideMethod": "fadeOut"
                    }
                    toastr.success(message);
                }
                
                
                function fieldSenseTosterInfo(message, isClosable) {
                    toastr.options = {
                        "closeButton": isClosable,
                        "debug": false,
                        "positionClass": "toast-top-center",
                        "onclick": null,
                        "showDuration": "1000",
                        "hideDuration": "1000",
                        "timeOut": "5000",
                        "extendedTimeOut": "1000",
                        "showEasing": "swing",
                        "hideEasing": "linear",
                        "showMethod": "fadeIn",
                        "hideMethod": "fadeOut"
                    }
                    toastr.info(message);
                }
                
                function fieldSenseTosterError(message, isClosable) {
                    toastr.options = {
                        "closeButton": isClosable,
                        "debug": false,
                        "positionClass": "toast-top-center",
                        "onclick": null,
                        "showDuration": "1000",
                        "hideDuration": "1000",
                        "timeOut": "5000",
                        "extendedTimeOut": "1000",
                        "showEasing": "swing",
                        "hideEasing": "linear",
                        "showMethod": "fadeIn",
                        "hideMethod": "fadeOut"
                    }
                    toastr.error(message);
                }
                
            </script> 
            <script src="assets/plugins/jquery-1.10.2.min.js" type="text/javascript"></script>
            <script src="assets/plugins/bootstrap-toastr/toastr.min.js" type="text/javascript"></script>
            <script src="assets/scripts/ui-toastr.js" type="text/javascript"></script>
    </body>
</html>
